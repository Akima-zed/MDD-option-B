<app-header></app-header>

<div class="page-wrapper">

  <!-- Top bar -->
  <div class="top-bar">
    <h1>Profil utilisateur</h1>
  </div>


  <!-- Formulaire profil -->
  <form [formGroup]="profileForm" (ngSubmit)="saveProfile()" class="create-form">

    <div class="field-group">
      <input type="text" formControlName="username" placeholder="Nom d'utilisateur *" />
      <div class="error" *ngIf="profileForm.get('username')?.invalid && profileForm.get('username')?.touched">
        Nom d'utilisateur requis (min. 3 caractères)
      </div>
    </div>

    <div class="field-group">
      <input type="email" formControlName="email" placeholder="Email *" />
      <div class="error" *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched">
        Email invalide
      </div>
    </div>

    <div class="field-group">
      <input type="password" formControlName="password" placeholder="Mot de passe *" />
      <div class="error" *ngIf="profileForm.get('password')?.invalid && profileForm.get('password')?.touched">
        Minimum 8 caractères, avec majuscule, minuscule, chiffre et caractère spécial
      </div>
    </div>

    

    <div class="form-actions">
      <button type="submit" class="submit-btn" [disabled]="profileForm.invalid || isLoading">
        {{ isLoading ? 'Sauvegarde...' : 'Sauvegarder' }}
      </button>
    </div>

  </form>

  <!-- Séparateur -->
  <hr class="separator" />


  <!-- Abonnements -->
  <section class="subscriptions-section">
    <h2>Abonnements</h2>

    <div class="theme-grid" *ngIf="subscribedThemes.length > 0">
      <div class="theme-card" *ngFor="let theme of subscribedThemes">
        <h3>{{ theme.name }}</h3>
        <p>{{ theme.description }}</p>

        <button class="unsubscribe-btn" (click)="unsubscribe(theme)">
          Se désabonner
        </button>
      </div>
    </div>

    <p *ngIf="subscribedThemes.length === 0" class="no-subscriptions">
      Vous n'êtes abonné à aucun thème.
    </p>
  </section>

</div>